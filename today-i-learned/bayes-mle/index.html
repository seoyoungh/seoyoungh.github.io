<!DOCTYPE html> <html lang="en"> <head> <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>베이즈 추정법과 최대가능도추정법 | Seoyoung Hong</title> <meta name="author" content="Seoyoung Hong"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://seoyoungh.github.io/today-i-learned/bayes-mle/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Seoyoung </span>Hong</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">베이즈 추정법과 최대가능도추정법</h1> <p class="post-meta">April 14, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/statistics"> <i class="fas fa-hashtag fa-sm"></i> statistics</a>   <a href="/blog/tag/mathematics"> <i class="fas fa-hashtag fa-sm"></i> mathematics</a>   <a href="/blog/tag/data-science"> <i class="fas fa-hashtag fa-sm"></i> data-science</a>     ·   <a href="/blog/category/today-i-learned"> <i class="fas fa-tag fa-sm"></i> today-i-learned</a>   </p> </header> <article class="post-content"> <p>모수 추정의 끝판왕 친구들! 두 개념은 자주 쓰이지만, 처음 접하면 꽤 헷갈리는 개념이므로 확실하게 짚고 넘어가자! <code class="language-plaintext highlighter-rouge">인공지능을 위한 수학</code> 책에서 내용의 일부를 발췌했다. (책 추천합니다. 하나 책꽂이에 있으면 든든해요.)</p> <h3 id="최대가능도추정">최대가능도추정</h3> <p><img src="/assets/images/mle.png" alt="mle" width="30%" height="30%"></p> <ul> <li>Maximum Likelihood Estimation, MLE</li> <li>최대가능도를 추정한다는 것은 파라미터 $\theta$에 대한 가능도함수 L($\theta$)를 최대화하는 모수 $\theta$ 값을 구하는 것이다.</li> <li>이때, 최댓값을 가지는 지점은 1계 미분을 했을 때 $dL(\theta)/d\theta = 0$이 되는 지점이며, 이때의 $\theta$를 구하면 된다.</li> </ul> <p><br></p> <h4 id="example">Example</h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>예를 들어, 주사위를 던져 숫자 1이 나올 확률은 1/6이다.
하지만 단언할 수는 없기 때문에 확률을 미지의 수로 두고 실험을 해보자.
만약 100번을 던졌을 때, 숫자 1이 나온게 20번이라고 하자.
</code></pre></div></div> <p>이때 1이 나올 확률을 $\theta$라고 두고, 위와 같은 결과가 나올 확률을 $L(\theta)$라고 하자. 그러면 아래와 같은 식이 나온다.</p> <p><img src="/assets/images/mle_eg.png" alt="mle_eg" width="30%" height="30%"></p> <p>이 식을 구했으니, 이 식을 미분해 0이 나오는 $\theta$를 구하면 된다. 하지만, 이 식의 차수는 매우 높기 때문에 미분을 하기엔 복잡하다. 따라서, 이 가능도함수에 자연로그를 붙여주어 <strong>로그가능도함수</strong>를 만들어주면 편하다.</p> <p><br></p> <h4 id="확률과-가능도의-차이">확률과 가능도의 차이</h4> <ul> <li>확률: 사건이 어떤 빈도로 일어날 것인지 나타낸 것</li> <li>가능도: 관측된 값들을 생성할 가능성이 가장 높은 실제 모수를 추정. 이때의 가능성을 수치로 표현한 것이 가능도이다.</li> </ul> <p><br></p> <h4 id="로그가능도함수">로그가능도함수</h4> <p><img src="/assets/images/log_mle.png" alt="log_mle" width="20%" height="20%"></p> <p>로그를 사용하면, 곱셈을 덧셈으로 바꿀 수 있어 고차 방정식을 1차 방정식 모양으로 바꿀 수 있다.</p> <p><br></p> <h4 id="summary">Summary</h4> <p>주사위 예제에서 로그가능도함수를 미분한 후 0이 되는 지점의 $\theta$를 찾으면, 0.2가 된다.</p> <p>이를 통해 우리는 “어떤 주사위를 던졌을 때, 숫자 1이 나올 확률로 <strong>가장 그럴듯한 것은</strong> 0.2이다.”라는 결론을 얻을 수 있다.</p> <p>파라미터가 여러 개인 경우는 각각의 파라미터에 대해 편미분을 하면 된다.</p> <p><br></p> <h3 id="베이즈-추정법">베이즈 추정법</h3> <p>최대가능도 추정법과 가장 다른 점은, 모수 $\theta$를 미지의 수로 보지 않고 확률변수로 본다는 점이다. 확률변수는 확률밀도함수를 갖고, 어떤 값이 가능성이 높고 어떤 값이 낮은지를 살펴본다는 것이다.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>관찰을 통해 얻은 데이터는 사전분포에 따라 얻어진 결과이므로,
그에 대한 조건부확률을 구하면 된다.
</code></pre></div></div> <p>라는 접근 방식으로 <strong>사후확률(조건부확률)</strong> 을 구한다. 결국 관측된 데이터를 기반으로 모수의 조건부 확률분포를 계산하는 작업이다.</p> <p>베이즈 정리, 사후확률을 추정하는 식은 아래와 같다. B는 관측값, A는 실제값이라고 직관적으로 생각해보자.</p> <p><img src="/assets/images/bayes.png" alt="bayes" width="30%" height="30%"></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P(A|B): 사후확률
- 사건 B를 관측한 후에, 그 원인이 되는 사건 A의 확률을 따졌다는 의미
P(B|A): 우도
P(A): 사전확률
- 사전에 미래에 어떤 사건이 일어날 확률을 측정한 것
</code></pre></div></div> <p><br></p> <h4 id="베이즈-추정법을-쓰는-이유">베이즈 추정법을 쓰는 이유</h4> <p>베이즈 추정법을 사용하는 이유는 <strong>추정된 모숫값 숫자 하나만으로는 추정의 신뢰도와 신뢰구간을 구할 수 없기 때문이다.</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>예를 들어 인터넷 쇼핑몰에 있는 두 개의 경쟁상품에 사용자 의견이 다음과 같이 붙어 있다고 하자.

상품 A: 전체 평가의견 3개, 좋아요 2개, 싫어요 1개
상품 B: 전체 평가의견 100개, 좋아요 60개, 싫어요 40개
</code></pre></div></div> <p>내가 이 상품을 사용했을 때 평가의견이 ‘좋아요’가 나올지 ‘싫어요’가 나올지는 베르누이분포 확률변수로 모형화할 수 있다. 최대가능도 추정법에 따르면 상품 A와 상품 B에서 ‘좋아요’가 나온 비율을 사용하여 베르누이 모수를 구하면 다음과 같이 상품 A의 모수가 높다.</p> <p>상품 A의 모수: $\frac{2}{3} = 0.67$ 상품 B의 모수: $\frac{60}{100} = 0.6$</p> <p>상품 B의 평가의견은 100개고 상품 A의 평가의견은 3개밖에 되지 않는데 상품 A의 모수가 더 높다고 더 높은 상품이라고 확신할 수 있는가? <strong>베이즈 추정법에서는 단순히 모수의 값을 하나의 숫자로 구하는 것이 아니므로 이러한 잘못된 결론을 내리지 않도록 도와준다.</strong></p> <p><a href="https://brunch.co.kr/@chris-song/59" target="_blank" rel="noopener noreferrer">베이즈 정리를 재밌게 정리한 블로그. 코난..🐶</a> <a href="https://sumniya.tistory.com/29" target="_blank" rel="noopener noreferrer">기존 빈도론과 베이지안이 어떻게 다른지 설명한 블로그</a></p> <p><br></p> <h3 id="comparison">Comparison</h3> <p>인공지능을 위한 수학 책에서는 둘을 다음과 같이 비교하고 있다. 둘 중 어느 것을 사용하더라도, 이는 모두 ‘추정’에 불과하므로 한계를 명확히 인지하고 데이터를 다뤄야 한다.</p> <p><br></p> <h4 id="수학적으로-정확한-최대가능도추정법">수학적으로 정확한 최대가능도추정법</h4> <ul> <li>진정한 확률 모델은 존재하며, 관찰된 데이터는 그러한 모델을 충실히 따르고 있다. 따라서, 시행을 반복하여 관찰하면 진정한 확률 모델이 보이기 시작할 것이다.</li> <li>하지만, 실험을 무한하게 할 수는 없으니 우리는 가장 그럴듯한 확률, 관찰되는 데이터를 믿을 수 밖에 없다.</li> <li>따라서 관찰 결과가 편향적이라면 치명적인 추정법이다. 시행 횟수가 충분해야 신뢰할 수 있다.</li> </ul> <p><br></p> <h4 id="실용적이지만-의심스러운-베이즈추정법">실용적이지만 의심스러운 베이즈추정법</h4> <ul> <li>지금까지의 관찰 결과를 근거로 사전분포를 가정한다. 이 사전분포에 따라 관찰 데이터가 얻어졌으므로, 그에 대한 조건부 확률을 구하면 된다고 한다.</li> </ul> </article> <script src="https://utteranc.es/client.js" repo="seoyoungh/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Seoyoung Hong. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-453QGGY7P1"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-453QGGY7P1");</script> </body> </html>