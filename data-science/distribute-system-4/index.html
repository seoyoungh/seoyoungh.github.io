<!DOCTYPE html> <html lang="en"> <head> <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>데이터 파이프라인의 자동화와 워크플로 관리 | Seoyoung Hong</title> <meta name="author" content="Seoyoung Hong"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://seoyoungh.github.io/data-science/distribute-system-4/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Seoyoung </span>Hong</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">데이터 파이프라인의 자동화와 워크플로 관리</h1> <p class="post-meta">August 12, 2020</p> <p class="post-tags"> <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/data-engineering"> <i class="fas fa-hashtag fa-sm"></i> data-engineering</a>   <a href="/blog/tag/database"> <i class="fas fa-hashtag fa-sm"></i> database</a>   <a href="/blog/tag/data-science"> <i class="fas fa-hashtag fa-sm"></i> data-science</a>     ·   <a href="/blog/category/data-science"> <i class="fas fa-tag fa-sm"></i> data-science</a>   </p> </header> <article class="post-content"> <p>아래 대부분의 내용은 도서 <strong>빅데이터를 지탱하는 기술</strong>에서 발췌했습니다.</p> <h4 id="워크플로-관리">워크플로 관리</h4> <ul> <li>기업 내의 정형적인 업무 프로세스를 진행하기 위한 구조</li> <li>자동화된 워크플로 <ul> <li>태스크는 정해진 스케줄에 따라 자동으로 실행되고, 무언가 비정상적 일이 발생한 경우에는 사람이 개입하여 문제를 해결</li> </ul> </li> </ul> <p><br></p> <h4 id="워크플로-관리-도구">워크플로 관리 도구</h4> <ul> <li>정기적으로 태스크를 실행하고 비정상적인 상태를 감지하여 그것에 대한 해결을 돕는 역할 <ul> <li>태스크를 정기적인 스케줄로 실행하고 그 결과 통지</li> <li>태스크 간의 의존 관계를 정하고, 정해진 순서대로 빠짐없이 실행하기</li> <li>태스크의 실행 결과를 보관하고, 오류 발생 시엔 재실행할 수 있도록 함</li> </ul> </li> <li>데이터 파이프라인의 실행에 특화한 오픈 소스의 워크플로 관리 도구가 여럿 개발되었음</li> <li> <strong>태스크</strong>: 데이터 파이프라인의 실행 과정에서 반복되는 개별 처리</li> </ul> <p><br></p> <h5 id="워크플로-관리-도구의-종류">워크플로 관리 도구의 종류</h5> <ul> <li>선언형(declarative) 도구 <ul> <li>XML, YAML 등의 서식으로 워크플로를 기술</li> <li>미리 제공된 기능만 이용할 수 있고, <strong>유지 보수성</strong> 높음</li> <li>동일 쿼리를 파라미터만 바꿔 여러 번 실행하거나 워크플로를 단순 반복으로 자동 생성하는 경우에 유용</li> </ul> </li> <li>스크립트형(scripting) 도구 <ul> <li>스크립트 언어로 워크플로를 정의하는 유형</li> <li> <strong>유연성</strong> 높음</li> </ul> </li> </ul> <p><br></p> <h4 id="발생-가능한-오류의-복구-방법">발생 가능한 오류의 복구 방법</h4> <ul> <li>기본적으로 워크플로 관리에서는 오류에 대해 수작업에 의한 <strong>복구(recovery)</strong> 를 전제한 태스크를 설계</li> <li>실패한 태스크는 모두 기록하여 그것을 나중에 재실행할 수 있도록 함</li> <li> <code class="language-plaintext highlighter-rouge">flow</code>: 워크플로 관리 도구에 의해 실행되는 일련의 태스크 <ul> <li>각 플로우에는 실행 시 고정 파라미터가 부여되어 있음 <ul> <li>e.g.) 일별 배칠 처리라면 특정 날짜가 파라미터가 -</li> </ul> </li> </ul> </li> <li> <strong>복구의 기초</strong> <ul> <li>동일 플로우에 동일 파라미터를 건네면 완전히 동일한 태스크가 실행되도록 한다.</li> <li>플로우가 도중에 실패해도 나중에 동일 파라미터로 재실행이 가능하기 때문</li> <li>대부분의 워크플로 관리 도구는 과거에 실행한 플로우와 그 파라미터를 자동으로 데이터베이스에 기록하게 되어 있음</li> <li>실패한 플로우를 선택, 재실행하면 복구가 완료됨</li> </ul> </li> <li>태스크를 되도록 작게 유지해야 오류로 인한 스케줄 지연을 최소한으로 억제할 수 있음</li> <li> <strong>재시도</strong> <ul> <li>여러 번 발생하는 오류에 대해 자동화해 수작업 없이 복구</li> <li>재시도 간격은 5분, 10분 정도로 둔다.</li> <li>재시도 횟수에는 주의가 필요 <ul> <li>재시도가 적으면 복구되기 전에 재시도가 종료되어 태스크 실행에 실패</li> <li>재시도가 너무 많으면 태스크가 실패하지 않은 것처럼 되기 때문에 중대한 문제가 발생해도 눈치채지 못함</li> </ul> </li> <li>이상적으로는 전혀 재시도 없이 모든 오류를 통지하는 것이 좋음</li> <li>재시도를 반복해도 문제가 없는 태스크라면, 1회나 2회의 재시도를 실행해도 좋지만, 오류의 원인을 그때마다 조사하여 오류가 일어나지 않도록 대책을 마련하는 것이 가장 좋음</li> </ul> </li> </ul> <p><br></p> <h5 id="원자성-조작과-멱등한-조작">원자성 조작과 멱등한 조작</h5> <ul> <li>실패 또는 성공만 있어야 한다. 도중까지 성공은 허가하지 않음.</li> <li>데이터의 중복 등을 막기 위해 각 태스크가 시스템에 변경을 가하는 것을 한 번만 할 수 있도록 한다.</li> <li> <strong>원자성 조작</strong> <ul> <li>쓰기가 필요한 수만큼 태스크를 나누도록 함</li> <li>하지만 여전히 재시도의 중복 가능성이 있음 <ul> <li>네트워크 경유로 로드 명령을 발행, 그 후에 통신이 끊어져 오류가 발생했다면 로드 명령이 취소될지 아니면 실행이 계속될지는 데이터베이스를 조작해봐야 안다.</li> </ul> </li> <li>재시도는 무효로 하고, 오류 발생 시에는 수작업으로 복구하는 편이 좋음</li> </ul> </li> <li> <strong>멱등한 조작</strong> <ul> <li>동일한 태스크를 여러 번 실행해도 동일한 결과가 되도록 하는 것</li> <li>SQL의 경우, 테이블을 삭제한 후 다시 만들기</li> <li> <strong>추가</strong>: 파일 업로드할 때마다 새로운 파일명을 만드는 경우 (데이터가 중복됨)</li> <li> <strong>치환</strong>: 동일 파일명으로 덮어쓰기 (반복해도 결과가 변하지 않음, 멱등함) <ul> <li>멱등한 태스크를 만들기 위해서는 태스크에 부여된 파라미터를 이용해 고유의 이름을 생성하고, 여러 번 실행해도 항상 치환이 시행되도록 설계</li> <li>e.g.) 날짜와 시간을 파라미터로 전달함으로써 치환 형의 태스크를 구현</li> </ul> </li> </ul> </li> <li> <code class="language-plaintext highlighter-rouge">테이블 파티셔닝</code> <ul> <li>테이블을 1일 또는 1시간마다 파티션으로 분할하고, 파티션 단위로 치환하게 함</li> </ul> </li> <li> <code class="language-plaintext highlighter-rouge">지수 백오프</code> <ul> <li>대다수의 데이터 전송 도구와 클라이언트 라이브러리는 재시도 횟수를 세세하게 제어하기 위한 옵션이 있음</li> <li>여러 시간 동안의 재시도가 예상되는 경우, 그 오류만을 대상으로 재시도 제어를 한다.</li> <li>재시도 횟수를 늘림과 동시에 조금씩 재시도 간격을 넓혀감</li> </ul> </li> </ul> <p><br></p> <h4 id="처리-효율을-최대화하기">처리 효율을 최대화하기</h4> <ul> <li>워크플로 관리 도구는 외부 시스템에 영향을 미치는 부하를 조정하는 역할도 담당</li> <li>태스크의 크기나 동시 실행수를 잘 제어해 <strong>안정적인 태스크 실행</strong>, <strong>자원의 유효한 활용</strong> 을 양립하게 한다.</li> <li>워크플로 관리 도구에 등록된 태스크는 모두 너무 크지도 않고, 너무 작지도 않은 적당한 크기로 분할된 다수의 태스크가 여러 워커로부터 호출되고 있는 상태가 된다.</li> </ul> <p><br></p> <h5 id="태스크-큐">태스크 큐</h5> <ul> <li>job queue, task queue</li> <li>너무 대량의 태스크를 동시 실행하면 서버에 과부하가 걸리므로, 제한을 두는 것</li> <li>모든 태스크를 일단 큐에 저장하고 일정 수의 워커 프로세스가 순서대로 꺼내면서 병렬화를 실현</li> </ul> </article> <script src="https://utteranc.es/client.js" repo="seoyoungh/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Seoyoung Hong. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-453QGGY7P1"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-453QGGY7P1");</script> </body> </html>