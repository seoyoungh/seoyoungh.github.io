<!DOCTYPE html> <html lang="en"> <head> <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Neural Network: XOR Problem, Back Propagation | Seoyoung Hong</title> <meta name="author" content="Seoyoung Hong"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://seoyoungh.github.io/deep-learning-zero-to-all/zerotoall-8/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Seoyoung </span>Hong</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Neural Network: XOR Problem, Back Propagation</h1> <p class="post-meta">October 10, 2019</p> <p class="post-tags"> <a href="/blog/2019"> <i class="fas fa-calendar fa-sm"></i> 2019 </a>   ·   <a href="/blog/tag/deep-learning"> <i class="fas fa-hashtag fa-sm"></i> deep-learning</a>   <a href="/blog/tag/tensorflow"> <i class="fas fa-hashtag fa-sm"></i> tensorflow</a>     ·   <a href="/blog/category/deep-learning-zero-to-all"> <i class="fas fa-tag fa-sm"></i> deep-learning-zero-to-all</a>   </p> </header> <article class="post-content"> <p><code class="language-plaintext highlighter-rouge">Sung Kim 교수님 강의로 공부하는 머신러닝 Section 9</code></p> <h3 id="neural-nets-nn-for-xor">Neural Nets (NN) for XOR</h3> <p>하나의 logistic regression unit은 XOR을 split하지 못해, 해당 문제를 해결할 수 없었다. 하지만 여러 개면 해결 가능했다. 하지만, 문제는 각각의 복잡한 네트워크의 w, b의 학습이 불가능하다는 것이었다.</p> <p><img src="/assets/images/nn_for_xor.png" alt="nn_for_xor" width="80%" height="80%"></p> <p>위처럼 3개의 유닛으로 XOR 문제를 풀 수 있다. 이 전체를 하나의 <code class="language-plaintext highlighter-rouge">neural network</code>라고 부르고, 네모 박스를 <code class="language-plaintext highlighter-rouge">unit</code>/<code class="language-plaintext highlighter-rouge">gate</code>/<code class="language-plaintext highlighter-rouge">perceptron</code>이라고 부른다.</p> <p><img src="/assets/images/nn_for_xor_2.png" alt="nn_for_xor_2" width="80%" height="80%"></p> <p>Neural network와 그 hypothesis를 위와 같이 정리할 수 있다. 여기서는 모든 weight과 bias가 주어졌지만, 실제로 모델은 어떻게 이 weight과 bias를 학습할까?</p> <p><br></p> <h3 id="partial-derivative">Partial derivative</h3> <p>우리말로는 <code class="language-plaintext highlighter-rouge">편미분</code>, 이 미분 기법은 backpropagation 알고리즘에서 매우 중요하다.</p> <ul> <li>Consider other variables as constants</li> <li>일변수 함수가 아니라 다변수 함수에서 하나의 변수만을 기준으로 하고 나머지 변수는 상수 로 보는 미분을 편미분이라고 한다.</li> </ul> <p>예시를 보자.</p> <p>\(f(x)=2x\) 이를 미분한 값은 2이다.</p> <p>\(f(x,y)=xy,\frac{\partial f}{\partial x}\) 이 식에서는 x를 편미분해야하기 때문에 y를 상수 취급 해준다. 따라서 값은 y이다.</p> <p>\(f(x,y)=xy,\frac{\partial f}{\partial y}\) 이 식에서는 y를 편미분해야하기 때문에 x를 상수 취급 해준다. 따라서 값은 x이다.</p> <p>더 공부하기 전에 몇 가지 미분을 복습해보자.</p> <p>$f(x)=x+x$를 미분하면 $1+1=2$, $f(x)=x+3$을 미분하면 $1+0=1$이 된다.</p> <p>\(f(x,y)=x+y,\frac{\partial f}{\partial y}\) x를 편미분하는 것이기 때문에 y를 상수취급하므로, 값은 $1+0=1$이 된다.y가 상수이기 때문에, 상수를 미분하면 0이 됨에 주의하자.</p> <p><br></p> <h3 id="chain-rule">Chain Rule</h3> \[f(g(x))=\frac{\partial f}{\partial x} = \frac{\partial f}{\partial g} \bullet \frac{\partial g}{\partial x}\] <p>뒤에 나올 <code class="language-plaintext highlighter-rouge">backpropagation</code>에서 이 rule을 사용한다.</p> <p><br></p> <h3 id="back-propagation">Back Propagation</h3> <p>모든 유닛의 weight과 bias를 계산하기엔 계산량이 너무 많아서, 편미분을 통해 deep network를 학습시킨다.</p> <p><img src="/assets/images/bp.png" alt="bp" width="80%" height="80%"></p> <p>모델을 돌린다. 그리고 예측값과 실제값을 비교해서 거기서 나온 error, 즉 cost 형태로 나온 것을 뒤에서 부터 앞으로 쭉 돌린다. 그래서 미분 값과, 실제로 어떻게 무엇을 조정해내는지 알아내는 알고리즘이 <code class="language-plaintext highlighter-rouge">backpropagation</code>이다.</p> <p>예를 들어보자.</p> \[f = wx + b, g=wx, f=g+b\] <p>위 수식을 neural network로 표현하면 다음과 같다.</p> <p><img src="/assets/images/bp2.png" alt="bp2" width="80%" height="80%"></p> <p>$w, x, b$ 각각이 $f$에 미치는 영향을 구하고 싶을 때, 그것이 각각 $\frac{\partial f}{\partial w}, \frac{\partial f}{\partial x}, \frac{\partial f}{\partial b}$가 될 것이다.</p> <p><img src="/assets/images/bp3.png" alt="bp3" width="80%" height="80%"></p> <p>다음과 같은 순서로 진행한다.</p> <ol> <li>g와 f의 값을 주어진 w,x,b의 값을 통해 구한다.</li> <li>g가 f에 미치는 영향, $\frac{\partial f}{\partial g}$를 구하고, b가 f에 미치는 영향, $\frac{\partial f}{\partial b}$을 구한다.</li> <li>chain rule을 이용해 $\frac{\partial f}{\partial w}, \frac{\partial f}{\partial x}$의 값도 구한다.</li> </ol> <p>$\frac{\partial f}{\partial w}$의 값이 5가 나왔는데, 이는 $w$값이 1만큼 바뀌면 $f$의 값이 5만큼 바뀐다는 것이다. 이 미분한 값들을 보고 우리는 $w,f,b$ 사이의 관계를 조절할 수 있다.</p> <p><img src="/assets/images/bp4.png" alt="bp4"></p> <p>아무리 layer가 많아도 <code class="language-plaintext highlighter-rouge">backpropagation</code>을 이용하면 된다. 가장 먼저, 마지막 node를 계산한다. 그 다음 단계로 가서 쭉 chain rule을 적용해 backpropagation을 진행한다. 이런 식으로 진행하면, 결국 최종 입력값과 최종 출력값 사이의 관계(미분값)을 알 수 있다.</p> <p><br></p> <h3 id="sigmoid-미분">Sigmoid 미분</h3> <p><img src="/assets/images/sd.png" alt="sd" width="50%" height="50%"></p> <p>sigmoid 미분도 복잡해 보이지만, backpropagation을 이용해 해결할 수 있다. 각 파트의 미분값이 뭔지 알기 때문에, local 미분 값들을 곱해 차근차근 끝까지 미분값을 구할 수 있다.</p> </article> <script src="https://utteranc.es/client.js" repo="seoyoungh/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Seoyoung Hong. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-453QGGY7P1"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-453QGGY7P1");</script> </body> </html>